<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.24.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="æœ¬æ•™ç¨‹å°†å®ç°å®Œæ•´çš„NFTè§£è´¨æŠ¼ç³»ç»Ÿï¼Œç”¨æˆ·å¯ä»¥å°†è´¨æŠ¼çš„NFTå–å›ï¼Œå¹¶å®ç°æƒ©ç½šæœºåˆ¶">
<meta property="og:type" content="article">
<meta property="og:title" content="Solanaè´¨æŠ¼-ç¼–å†™ä¸€ä¸ªåº”ç”¨çº§åˆ«çš„è´¨æŠ¼åˆçº¦-è§£è´¨æŠ¼é€»è¾‘">
<meta property="og:url" content="http://example.com/2025/09/19/Solana%E8%B4%A8%E6%8A%BC-%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E5%BA%94%E7%94%A8%E7%BA%A7%E5%88%AB%E7%9A%84%E8%B4%A8%E6%8A%BC%E5%90%88%E7%BA%A6-%E8%A7%A3%E8%B4%A8%E6%8A%BC%E9%80%BB%E8%BE%91/index.html">
<meta property="og:site_name" content="samxie52">
<meta property="og:description" content="æœ¬æ•™ç¨‹å°†å®ç°å®Œæ•´çš„NFTè§£è´¨æŠ¼ç³»ç»Ÿï¼Œç”¨æˆ·å¯ä»¥å°†è´¨æŠ¼çš„NFTå–å›ï¼Œå¹¶å®ç°æƒ©ç½šæœºåˆ¶">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-09-19T12:59:18.000Z">
<meta property="article:modified_time" content="2025-09-20T00:11:38.404Z">
<meta property="article:author" content="samxie">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2025/09/19/Solana%E8%B4%A8%E6%8A%BC-%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E5%BA%94%E7%94%A8%E7%BA%A7%E5%88%AB%E7%9A%84%E8%B4%A8%E6%8A%BC%E5%90%88%E7%BA%A6-%E8%A7%A3%E8%B4%A8%E6%8A%BC%E9%80%BB%E8%BE%91/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2025/09/19/Solana%E8%B4%A8%E6%8A%BC-%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E5%BA%94%E7%94%A8%E7%BA%A7%E5%88%AB%E7%9A%84%E8%B4%A8%E6%8A%BC%E5%90%88%E7%BA%A6-%E8%A7%A3%E8%B4%A8%E6%8A%BC%E9%80%BB%E8%BE%91/","path":"2025/09/19/Solanaè´¨æŠ¼-ç¼–å†™ä¸€ä¸ªåº”ç”¨çº§åˆ«çš„è´¨æŠ¼åˆçº¦-è§£è´¨æŠ¼é€»è¾‘/","title":"Solanaè´¨æŠ¼-ç¼–å†™ä¸€ä¸ªåº”ç”¨çº§åˆ«çš„è´¨æŠ¼åˆçº¦-è§£è´¨æŠ¼é€»è¾‘"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Solanaè´¨æŠ¼-ç¼–å†™ä¸€ä¸ªåº”ç”¨çº§åˆ«çš„è´¨æŠ¼åˆçº¦-è§£è´¨æŠ¼é€»è¾‘ | samxie52</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  






  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">samxie52</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">æ¦‚è¿°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A41-%E6%89%A9%E5%B1%95%E8%B4%A8%E6%8A%BC%E4%BF%A1%E6%81%AF%E7%BB%93%E6%9E%84-%E6%B7%BB%E5%8A%A0%E6%83%A9%E7%BD%9A%E8%AE%A1%E7%AE%97"><span class="nav-number">2.</span> <span class="nav-text">æ­¥éª¤1: æ‰©å±•è´¨æŠ¼ä¿¡æ¯ç»“æ„ - æ·»åŠ æƒ©ç½šè®¡ç®—</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A42-%E5%AE%9E%E7%8E%B0NFT%E8%A7%A3%E8%B4%A8%E6%8A%BC%E6%8C%87%E4%BB%A4"><span class="nav-number">3.</span> <span class="nav-text">æ­¥éª¤2: å®ç°NFTè§£è´¨æŠ¼æŒ‡ä»¤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A43-%E6%B3%A8%E5%86%8C%E8%A7%A3%E8%B4%A8%E6%8A%BC%E6%8C%87%E4%BB%A4"><span class="nav-number">4.</span> <span class="nav-text">æ­¥éª¤3: æ³¨å†Œè§£è´¨æŠ¼æŒ‡ä»¤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A44-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%A7%A3%E8%B4%A8%E6%8A%BC%E5%AE%9E%E7%8E%B0"><span class="nav-number">5.</span> <span class="nav-text">æ­¥éª¤4: å®¢æˆ·ç«¯è§£è´¨æŠ¼å®ç°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A45-%E5%AE%8C%E6%95%B4%E5%BA%94%E7%94%A8%E6%BC%94%E7%A4%BA"><span class="nav-number">6.</span> <span class="nav-text">æ­¥éª¤5: å®Œæ•´åº”ç”¨æ¼”ç¤º</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E8%A6%81%E7%82%B9%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90"><span class="nav-number">7.</span> <span class="nav-text">æŠ€æœ¯è¦ç‚¹æ·±åº¦è§£æ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%9D%83%E9%99%90%E9%AA%8C%E8%AF%81%E6%9C%BA%E5%88%B6"><span class="nav-number">7.1.</span> <span class="nav-text">1. æƒé™éªŒè¯æœºåˆ¶</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#A-%E5%8F%8C%E9%87%8D%E6%9D%83%E9%99%90%E6%A3%80%E6%9F%A5"><span class="nav-number">7.1.1.</span> <span class="nav-text">A. åŒé‡æƒé™æ£€æŸ¥</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#B-PDA%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6"><span class="nav-number">7.1.2.</span> <span class="nav-text">B. PDAæƒé™æ§åˆ¶</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%83%A9%E7%BD%9A%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3"><span class="nav-number">7.2.</span> <span class="nav-text">2. æƒ©ç½šæœºåˆ¶è¯¦è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#A-%E7%BA%BF%E6%80%A7%E8%A1%B0%E5%87%8F%E5%85%AC%E5%BC%8F"><span class="nav-number">7.2.1.</span> <span class="nav-text">A. çº¿æ€§è¡°å‡å…¬å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#B-%E7%BB%8F%E6%B5%8E%E5%AD%A6%E8%80%83%E9%87%8F"><span class="nav-number">7.2.2.</span> <span class="nav-text">B. ç»æµå­¦è€ƒé‡</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E4%BB%A3%E5%B8%81%E9%94%80%E6%AF%81%E6%9C%BA%E5%88%B6"><span class="nav-number">7.3.</span> <span class="nav-text">3. ä»£å¸é”€æ¯æœºåˆ¶</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#A-Burn%E6%93%8D%E4%BD%9C"><span class="nav-number">7.3.1.</span> <span class="nav-text">A. Burnæ“ä½œ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#B-%E7%BB%8F%E6%B5%8E%E5%BD%B1%E5%93%8D"><span class="nav-number">7.3.2.</span> <span class="nav-text">B. ç»æµå½±å“</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E7%AD%96%E7%95%A5"><span class="nav-number">7.4.</span> <span class="nav-text">4. é”™è¯¯å¤„ç†ç­–ç•¥</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#A-%E9%A2%84%E6%A3%80%E6%9F%A5%E6%9C%BA%E5%88%B6"><span class="nav-number">7.4.1.</span> <span class="nav-text">A. é¢„æ£€æŸ¥æœºåˆ¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#B-%E8%BE%B9%E7%95%8C%E6%9D%A1%E4%BB%B6%E5%A4%84%E7%90%86"><span class="nav-number">7.4.2.</span> <span class="nav-text">B. è¾¹ç•Œæ¡ä»¶å¤„ç†</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-Gas%E4%BC%98%E5%8C%96%E7%AD%96%E7%95%A5"><span class="nav-number">7.5.</span> <span class="nav-text">5. Gasä¼˜åŒ–ç­–ç•¥</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#A-%E6%9D%A1%E4%BB%B6%E6%89%A7%E8%A1%8C"><span class="nav-number">7.5.1.</span> <span class="nav-text">A. æ¡ä»¶æ‰§è¡Œ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#B-%E8%B4%A6%E6%88%B7%E5%A4%8D%E7%94%A8"><span class="nav-number">7.5.2.</span> <span class="nav-text">B. è´¦æˆ·å¤ç”¨</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90"><span class="nav-number">8.</span> <span class="nav-text">å®‰å…¨æ€§åˆ†æ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E9%87%8D%E5%85%A5%E6%94%BB%E5%87%BB%E9%98%B2%E6%8A%A4"><span class="nav-number">8.1.</span> <span class="nav-text">1. é‡å…¥æ”»å‡»é˜²æŠ¤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E9%98%B2%E6%8A%A4"><span class="nav-number">8.2.</span> <span class="nav-text">2. æƒé™æå‡é˜²æŠ¤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%95%B0%E5%80%BC%E6%BA%A2%E5%87%BA%E9%98%B2%E6%8A%A4"><span class="nav-number">8.3.</span> <span class="nav-text">3. æ•°å€¼æº¢å‡ºé˜²æŠ¤</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%A9%E5%B1%95%E5%8A%9F%E8%83%BD%E5%BB%BA%E8%AE%AE"><span class="nav-number">9.</span> <span class="nav-text">æ‰©å±•åŠŸèƒ½å»ºè®®</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%B8%90%E8%BF%9B%E5%BC%8F%E8%A7%A3%E8%B4%A8%E6%8A%BC"><span class="nav-number">9.1.</span> <span class="nav-text">1. æ¸è¿›å¼è§£è´¨æŠ¼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%8A%A8%E6%80%81%E6%83%A9%E7%BD%9A%E7%8E%87"><span class="nav-number">9.2.</span> <span class="nav-text">2. åŠ¨æ€æƒ©ç½šç‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E5%A5%96%E5%8A%B1%E7%B4%AF%E7%A7%AF%E6%9C%BA%E5%88%B6"><span class="nav-number">9.3.</span> <span class="nav-text">3. å¥–åŠ±ç´¯ç§¯æœºåˆ¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E6%89%B9%E9%87%8F%E6%93%8D%E4%BD%9C%E6%94%AF%E6%8C%81"><span class="nav-number">9.4.</span> <span class="nav-text">4. æ‰¹é‡æ“ä½œæ”¯æŒ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E6%80%BB%E7%BB%93"><span class="nav-number">10.</span> <span class="nav-text">æœ€ä½³å®è·µæ€»ç»“</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%AE%89%E5%85%A8%E4%BC%98%E5%85%88"><span class="nav-number">10.1.</span> <span class="nav-text">1. å®‰å…¨ä¼˜å…ˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C"><span class="nav-number">10.2.</span> <span class="nav-text">2. ç”¨æˆ·ä½“éªŒ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E7%BB%8F%E6%B5%8E%E8%AE%BE%E8%AE%A1"><span class="nav-number">10.3.</span> <span class="nav-text">3. ç»æµè®¾è®¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E5%8F%AF%E6%89%A9%E5%B1%95%E6%80%A7"><span class="nav-number">10.4.</span> <span class="nav-text">4. å¯æ‰©å±•æ€§</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">samxie</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">59</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/09/19/Solana%E8%B4%A8%E6%8A%BC-%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E5%BA%94%E7%94%A8%E7%BA%A7%E5%88%AB%E7%9A%84%E8%B4%A8%E6%8A%BC%E5%90%88%E7%BA%A6-%E8%A7%A3%E8%B4%A8%E6%8A%BC%E9%80%BB%E8%BE%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="samxie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="samxie52">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Solanaè´¨æŠ¼-ç¼–å†™ä¸€ä¸ªåº”ç”¨çº§åˆ«çš„è´¨æŠ¼åˆçº¦-è§£è´¨æŠ¼é€»è¾‘ | samxie52">
      <meta itemprop="description" content="æœ¬æ•™ç¨‹å°†å®ç°å®Œæ•´çš„NFTè§£è´¨æŠ¼ç³»ç»Ÿï¼Œç”¨æˆ·å¯ä»¥å°†è´¨æŠ¼çš„NFTå–å›ï¼Œå¹¶å®ç°æƒ©ç½šæœºåˆ¶">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Solanaè´¨æŠ¼-ç¼–å†™ä¸€ä¸ªåº”ç”¨çº§åˆ«çš„è´¨æŠ¼åˆçº¦-è§£è´¨æŠ¼é€»è¾‘
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-09-19 20:59:18" itemprop="dateCreated datePublished" datetime="2025-09-19T20:59:18+08:00">2025-09-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-09-20 08:11:38" itemprop="dateModified" datetime="2025-09-20T08:11:38+08:00">2025-09-20</time>
    </span>

  
    <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

            <div class="post-description">æœ¬æ•™ç¨‹å°†å®ç°å®Œæ•´çš„NFTè§£è´¨æŠ¼ç³»ç»Ÿï¼Œç”¨æˆ·å¯ä»¥å°†è´¨æŠ¼çš„NFTå–å›ï¼Œå¹¶å®ç°æƒ©ç½šæœºåˆ¶</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>åœ¨ä¸Šä¸€ç¯‡æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å®ç°äº†NFTè´¨æŠ¼åŠŸèƒ½ã€‚æœ¬ç¯‡å°†å®Œæˆè´¨æŠ¼ç³»ç»Ÿçš„å¦ä¸€åŠï¼š<strong>è§£è´¨æŠ¼é€»è¾‘</strong>ã€‚è§£è´¨æŠ¼ä¸ä»…ä»…æ˜¯è´¨æŠ¼çš„é€†å‘æ“ä½œï¼Œè¿˜åŒ…å«äº†ä¸€ä¸ªé‡è¦çš„ç»æµæœºåˆ¶â€”â€”<strong>æ—©æœŸè§£è´¨æŠ¼æƒ©ç½š</strong>ï¼Œè¿™æ˜¯DeFiåè®®ä¸­å¸¸è§çš„è®¾è®¡æ¨¡å¼ã€‚</p>
<p><strong>è§£è´¨æŠ¼æ ¸å¿ƒåŠŸèƒ½</strong>:</p>
<ol>
<li>éªŒè¯ç”¨æˆ·æƒé™ï¼ˆåªæœ‰è´¨æŠ¼è€…æ‰èƒ½è§£è´¨æŠ¼ï¼‰</li>
<li>å°†NFTä»ç¨‹åºæ‰˜ç®¡è´¦æˆ·è½¬å›ç”¨æˆ·è´¦æˆ·</li>
<li>æ ¹æ®è´¨æŠ¼æ—¶é•¿è®¡ç®—æƒ©ç½šé‡‘é¢</li>
<li>é”€æ¯ç›¸åº”æ•°é‡çš„å¥–åŠ±ä»£å¸ä½œä¸ºæƒ©ç½š</li>
</ol>
<h2 id="æ­¥éª¤1-æ‰©å±•è´¨æŠ¼ä¿¡æ¯ç»“æ„-æ·»åŠ æƒ©ç½šè®¡ç®—"><a href="#æ­¥éª¤1-æ‰©å±•è´¨æŠ¼ä¿¡æ¯ç»“æ„-æ·»åŠ æƒ©ç½šè®¡ç®—" class="headerlink" title="æ­¥éª¤1: æ‰©å±•è´¨æŠ¼ä¿¡æ¯ç»“æ„ - æ·»åŠ æƒ©ç½šè®¡ç®—"></a>æ­¥éª¤1: æ‰©å±•è´¨æŠ¼ä¿¡æ¯ç»“æ„ - æ·»åŠ æƒ©ç½šè®¡ç®—</h2><p><strong>ç›®çš„</strong>: åœ¨åŸæœ‰è´¨æŠ¼ä¿¡æ¯ç»“æ„åŸºç¡€ä¸Šï¼Œæ·»åŠ è®¡ç®—æ—©æœŸè§£è´¨æŠ¼æƒ©ç½šçš„é€»è¾‘ã€‚</p>
<p><strong>æ–‡ä»¶ä½ç½®</strong>: <code>/programs/ibuidl-socail/src/state/stake.rs</code></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::cmp::max;  <span class="comment">// å¼•å…¥maxå‡½æ•°ï¼Œç”¨äºæ•°å€¼æ¯”è¾ƒ</span></span><br><span class="line"><span class="keyword">use</span> anchor_lang::&#123;prelude::*, solana_program::clock&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è´¨æŠ¼ä¿¡æ¯ç»“æ„ä½“ï¼ˆä¸è´¨æŠ¼æ•™ç¨‹ç›¸åŒï¼‰</span></span><br><span class="line"><span class="meta">#[account]</span></span><br><span class="line"><span class="meta">#[derive(InitSpace)]</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">struct</span> <span class="title class_">IbuidlStake</span> &#123;</span><br><span class="line">    <span class="keyword">pub</span> staker: Pubkey,           <span class="comment">// è´¨æŠ¼è€…çš„å…¬é’¥åœ°å€</span></span><br><span class="line">    <span class="keyword">pub</span> nft_mint_account: Pubkey, <span class="comment">// è¢«è´¨æŠ¼NFTçš„mintè´¦æˆ·åœ°å€</span></span><br><span class="line">    <span class="keyword">pub</span> staked_at: <span class="type">u64</span>,          <span class="comment">// è´¨æŠ¼æ—¶çš„epochæ—¶é—´</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">IbuidlStake</span> &#123;</span><br><span class="line">    <span class="comment">// PDAç§å­å‰ç¼€ï¼Œä¸è´¨æŠ¼æ—¶ä¿æŒä¸€è‡´</span></span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">const</span> SEED_PREFIX: &amp;<span class="symbol">&#x27;static</span> <span class="type">str</span> = <span class="string">&quot;stake_v1&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºæ–°çš„è´¨æŠ¼ä¿¡æ¯å®ä¾‹ï¼ˆä¸è´¨æŠ¼æ•™ç¨‹ç›¸åŒï¼‰</span></span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">new</span>(staker: Pubkey, nft_mint_account: Pubkey) <span class="punctuation">-&gt;</span> <span class="keyword">Self</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">clock</span> = clock::Clock::<span class="title function_ invoke__">get</span>().<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">staked_at</span> = clock.epoch;</span><br><span class="line">        <span class="keyword">Self</span> &#123;</span><br><span class="line">            staker,</span><br><span class="line">            nft_mint_account,</span><br><span class="line">            staked_at,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ğŸ”‘ æ ¸å¿ƒæ–°åŠŸèƒ½ï¼šè®¡ç®—æ—©æœŸè§£è´¨æŠ¼çš„æƒ©ç½šé‡‘é¢</span></span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">salvage_value</span>(&amp;<span class="keyword">self</span>, amount: <span class="type">u64</span>) <span class="punctuation">-&gt;</span> <span class="type">u64</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–å½“å‰åŒºå—é“¾æ—¶é—´</span></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">clock</span> = Clock::<span class="title function_ invoke__">get</span>().<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">now</span> = clock.epoch;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¡ç®—è´¨æŠ¼æŒç»­æ—¶é—´ï¼ˆä»¥epochä¸ºå•ä½ï¼‰</span></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">staked_duration</span> = now - <span class="keyword">self</span>.staked_at;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æƒ©ç½šå…¬å¼ï¼šæ¯ä¸ªepochå‡å°‘2%ï¼Œæœ€å¤šå‡å°‘100%</span></span><br><span class="line">        <span class="comment">// ä¾‹å¦‚ï¼š</span></span><br><span class="line">        <span class="comment">// - 0 epoch: 100% æƒ©ç½š (ç«‹å³è§£è´¨æŠ¼æŸå¤±100%)</span></span><br><span class="line">        <span class="comment">// - 1 epoch: 98% æƒ©ç½š</span></span><br><span class="line">        <span class="comment">// - 25 epoch: 50% æƒ©ç½š</span></span><br><span class="line">        <span class="comment">// - 50+ epoch: 0% æƒ©ç½š (æ— æŸå¤±)</span></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">penalty_rate</span> = <span class="title function_ invoke__">max</span>(<span class="number">0</span>, <span class="number">100</span> - staked_duration * <span class="number">2</span>) <span class="keyword">as</span> <span class="type">f64</span> / <span class="number">100.0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®¡ç®—éœ€è¦é”€æ¯çš„ä»£å¸æ•°é‡</span></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">burn_amount</span> = (amount <span class="keyword">as</span> <span class="type">f64</span> * penalty_rate) <span class="keyword">as</span> <span class="type">u64</span>;</span><br><span class="line">        </span><br><span class="line">        burn_amount</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æƒ©ç½šæœºåˆ¶è®¾è®¡è§£æ</strong>:</p>
<ul>
<li><strong>çº¿æ€§é€’å‡</strong>: æƒ©ç½šéšæ—¶é—´çº¿æ€§å‡å°‘ï¼Œé¼“åŠ±é•¿æœŸè´¨æŠ¼</li>
<li><strong>å®Œå…¨æ¶ˆé™¤</strong>: 50ä¸ªepochåæ— æƒ©ç½šï¼Œå¹³è¡¡ç”¨æˆ·ä½“éªŒ</li>
<li><strong>ç»æµæ¿€åŠ±</strong>: é˜²æ­¢çŸ­æœŸæŠ•æœºï¼Œç¨³å®šä»£å¸ç»æµ</li>
</ul>
<h2 id="æ­¥éª¤2-å®ç°NFTè§£è´¨æŠ¼æŒ‡ä»¤"><a href="#æ­¥éª¤2-å®ç°NFTè§£è´¨æŠ¼æŒ‡ä»¤" class="headerlink" title="æ­¥éª¤2: å®ç°NFTè§£è´¨æŠ¼æŒ‡ä»¤"></a>æ­¥éª¤2: å®ç°NFTè§£è´¨æŠ¼æŒ‡ä»¤</h2><p><strong>ç›®çš„</strong>: å®ç°å®Œæ•´çš„è§£è´¨æŠ¼æµç¨‹ï¼ŒåŒ…æ‹¬æƒé™éªŒè¯ã€NFTè½¬ç§»ã€æƒ©ç½šæ‰§è¡Œã€‚</p>
<p><strong>æ–‡ä»¶ä½ç½®</strong>: <code>/programs/ibuidl-socail/src/instructions/nft_unstake.rs</code></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> anchor_lang::prelude::*;</span><br><span class="line"><span class="keyword">use</span> anchor_spl::&#123;</span><br><span class="line">    associated_token::AssociatedToken,</span><br><span class="line">    token::&#123;burn, transfer, Burn, Mint, Token, TokenAccount, Transfer&#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> crate::state::IbuidlStake;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NFTè§£è´¨æŠ¼æ ¸å¿ƒé€»è¾‘å‡½æ•°</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">unstake</span>(ctx: Context&lt;NftUnstake&gt;) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;()&gt; &#123;</span><br><span class="line">    <span class="comment">// ğŸ”’ ç¬¬ä¸€æ­¥ï¼šæƒé™éªŒè¯</span></span><br><span class="line">    <span class="comment">// éªŒè¯è´¨æŠ¼ä¿¡æ¯ä¸­çš„NFT mintåœ°å€ä¸å½“å‰æ“ä½œçš„NFTåŒ¹é…</span></span><br><span class="line">    require!(</span><br><span class="line">        &amp;ctx.accounts.stake_info.nft_mint_account.<span class="title function_ invoke__">key</span>() == &amp;ctx.accounts.nft_mint_account.<span class="title function_ invoke__">key</span>(),</span><br><span class="line">        UnstakeError::NoAuthority,  <span class="comment">// å¦‚æœä¸åŒ¹é…ï¼ŒæŠ›å‡ºæ— æƒé™é”™è¯¯</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éªŒè¯è°ƒç”¨è€…æ˜¯åŸè´¨æŠ¼è€…</span></span><br><span class="line">    require!(</span><br><span class="line">        &amp;ctx.accounts.stake_info.staker.<span class="title function_ invoke__">key</span>() == &amp;ctx.accounts.authority.<span class="title function_ invoke__">key</span>(),</span><br><span class="line">        UnstakeError::NoAuthority,  <span class="comment">// å¦‚æœä¸æ˜¯åŸè´¨æŠ¼è€…ï¼ŒæŠ›å‡ºæ— æƒé™é”™è¯¯</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    msg!(<span class="string">&quot;âœ… Authority verification passed&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ğŸ” ç¬¬äºŒæ­¥ï¼šå‡†å¤‡PDAç­¾å</span></span><br><span class="line">    <span class="comment">// æ„å»ºè´¨æŠ¼ä¿¡æ¯PDAçš„ç­¾åç§å­ï¼Œç”¨äºç¨‹åºä»£è¡¨PDAæ‰§è¡Œè½¬è´¦</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">nft_mint_account</span> = ctx.accounts.nft_mint_account.<span class="title function_ invoke__">key</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">signer_seeds</span>: &amp;[&amp;[&amp;[<span class="type">u8</span>]]] = &amp;[&amp;[</span><br><span class="line">        IbuidlStake::SEED_PREFIX.<span class="title function_ invoke__">as_bytes</span>(),  <span class="comment">// &quot;stake_v1&quot;</span></span><br><span class="line">        nft_mint_account.<span class="title function_ invoke__">as_ref</span>(),            <span class="comment">// NFT mintåœ°å€</span></span><br><span class="line">        &amp;[ctx.bumps.stake_info],              <span class="comment">// bumpå€¼ï¼Œç¡®ä¿PDAæœ‰æ•ˆ</span></span><br><span class="line">    ]];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ğŸ”„ ç¬¬ä¸‰æ­¥ï¼šå°†NFTä»ç¨‹åºæ‰˜ç®¡è´¦æˆ·è½¬å›ç”¨æˆ·è´¦æˆ·</span></span><br><span class="line">    <span class="title function_ invoke__">transfer</span>(</span><br><span class="line">        CpiContext::<span class="title function_ invoke__">new</span>(</span><br><span class="line">            ctx.accounts.token_program.<span class="title function_ invoke__">to_account_info</span>(),  <span class="comment">// SPL Tokenç¨‹åº</span></span><br><span class="line">            Transfer &#123;</span><br><span class="line">                from: ctx.accounts.program_receipt_nft_ata.<span class="title function_ invoke__">to_account_info</span>(), <span class="comment">// æºï¼šç¨‹åºæ‰˜ç®¡è´¦æˆ·</span></span><br><span class="line">                to: ctx.accounts.nft_associated_token_account.<span class="title function_ invoke__">to_account_info</span>(), <span class="comment">// ç›®æ ‡ï¼šç”¨æˆ·NFTè´¦æˆ·</span></span><br><span class="line">                authority: ctx.accounts.stake_info.<span class="title function_ invoke__">to_account_info</span>(),         <span class="comment">// æƒé™ï¼šè´¨æŠ¼ä¿¡æ¯PDA</span></span><br><span class="line">            &#125;,</span><br><span class="line">        )</span><br><span class="line">        .<span class="title function_ invoke__">with_signer</span>(signer_seeds), <span class="comment">// ä½¿ç”¨PDAç­¾åæˆæƒè½¬è´¦</span></span><br><span class="line">        <span class="number">1</span>, <span class="comment">// è½¬ç§»æ•°é‡ï¼š1ä¸ªNFT</span></span><br><span class="line">    )?;</span><br><span class="line"></span><br><span class="line">    msg!(<span class="string">&quot;ğŸ”„ NFT transferred back to user&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ğŸ’° ç¬¬å››æ­¥ï¼šè®¡ç®—å¹¶æ‰§è¡Œæƒ©ç½š</span></span><br><span class="line">    <span class="comment">// åŸºäºåŸå§‹å¥–åŠ±é‡‘é¢è®¡ç®—æƒ©ç½šæ•°é‡</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">original_reward</span> = <span class="number">4206000</span>;  <span class="comment">// ä¸è´¨æŠ¼æ—¶é“¸é€ çš„æ•°é‡ä¿æŒä¸€è‡´</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">penalty_amount</span> = ctx.accounts.stake_info.<span class="title function_ invoke__">salvage_value</span>(original_reward);</span><br><span class="line"></span><br><span class="line">    msg!(<span class="string">&quot;ğŸ’¸ Calculated penalty amount: &#123;&#125;&quot;</span>, penalty_amount);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæœ‰æƒ©ç½šé‡‘é¢ï¼Œåˆ™é”€æ¯ç›¸åº”æ•°é‡çš„å¥–åŠ±ä»£å¸</span></span><br><span class="line">    <span class="keyword">if</span> penalty_amount &gt; <span class="number">0</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">burn</span>(</span><br><span class="line">            CpiContext::<span class="title function_ invoke__">new</span>(</span><br><span class="line">                ctx.accounts.token_program.<span class="title function_ invoke__">to_account_info</span>(),  <span class="comment">// SPL Tokenç¨‹åº</span></span><br><span class="line">                Burn &#123;</span><br><span class="line">                    mint: ctx.accounts.token_mint_account.<span class="title function_ invoke__">to_account_info</span>(),           <span class="comment">// å¥–åŠ±ä»£å¸mint</span></span><br><span class="line">                    from: ctx.accounts.associated_token_account.<span class="title function_ invoke__">to_account_info</span>(),     <span class="comment">// ç”¨æˆ·å¥–åŠ±ä»£å¸è´¦æˆ·</span></span><br><span class="line">                    authority: ctx.accounts.authority.<span class="title function_ invoke__">to_account_info</span>(),               <span class="comment">// é”€æ¯æƒé™ï¼šç”¨æˆ·</span></span><br><span class="line">                &#125;,</span><br><span class="line">            ),</span><br><span class="line">            penalty_amount, <span class="comment">// é”€æ¯çš„ä»£å¸æ•°é‡</span></span><br><span class="line">        )?;</span><br><span class="line"></span><br><span class="line">        msg!(<span class="string">&quot;ğŸ”¥ Penalty tokens burned successfully&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        msg!(<span class="string">&quot;ğŸ‰ No penalty - full staking period completed!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è‡ªå®šä¹‰é”™è¯¯ç±»å‹å®šä¹‰</span></span><br><span class="line"><span class="meta">#[error_code]</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">enum</span> <span class="title class_">UnstakeError</span> &#123;</span><br><span class="line">    <span class="meta">#[msg(<span class="string">&quot;User is not the authority&quot;</span>)]</span>  <span class="comment">// ç”¨æˆ·æ— æƒé™é”™è¯¯æ¶ˆæ¯</span></span><br><span class="line">    NoAuthority,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NFTè§£è´¨æŠ¼æŒ‡ä»¤æ‰€éœ€çš„è´¦æˆ·ç»“æ„</span></span><br><span class="line"><span class="meta">#[derive(Accounts)]</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">struct</span> <span class="title class_">NftUnstake</span>&lt;<span class="symbol">&#x27;info</span>&gt; &#123;</span><br><span class="line">    <span class="comment">// è´¨æŠ¼ä¿¡æ¯è´¦æˆ·ï¼ˆå¿…é¡»ä¸è´¨æŠ¼æ—¶åˆ›å»ºçš„è´¦æˆ·ä¸€è‡´ï¼‰</span></span><br><span class="line">    <span class="meta">#[account(</span></span><br><span class="line"><span class="meta">        mut,                                   // å¯å˜ï¼Œè™½ç„¶æœ¬ä¾‹ä¸­ä¸ä¿®æ”¹ï¼Œä½†ä¿æŒä¸€è‡´æ€§</span></span><br><span class="line"><span class="meta">        seeds = [</span></span><br><span class="line"><span class="meta">            IbuidlStake::SEED_PREFIX.as_bytes(), // <span class="string">&quot;stake_v1&quot;</span></span></span><br><span class="line"><span class="meta">            nft_mint_account.key().as_ref(),     // NFT mintåœ°å€ä½œä¸ºç§å­</span></span><br><span class="line"><span class="meta">        ]</span>,</span><br><span class="line">        bump,                                  <span class="comment">// è‡ªåŠ¨å¯»æ‰¾bumpå€¼</span></span><br><span class="line">    )]</span><br><span class="line">    <span class="keyword">pub</span> stake_info: <span class="type">Box</span>&lt;Account&lt;<span class="symbol">&#x27;info</span>, IbuidlStake&gt;&gt;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¨‹åºNFTæ‰˜ç®¡è´¦æˆ·ï¼ˆNFTå°†ä»è¿™é‡Œè½¬å‡ºï¼‰</span></span><br><span class="line">    <span class="meta">#[account(</span></span><br><span class="line"><span class="meta">        mut,                                   // å¯å˜ï¼ŒNFTå°†è¢«è½¬å‡º</span></span><br><span class="line"><span class="meta">        associated_token::mint = nft_mint_account,  // å…³è”åˆ°NFT mint</span></span><br><span class="line"><span class="meta">        associated_token::authority = stake_info    // è´¦æˆ·æƒé™å½’è´¨æŠ¼ä¿¡æ¯PDAæ‰€æœ‰</span></span><br><span class="line"><span class="meta">    )]</span></span><br><span class="line">    <span class="keyword">pub</span> program_receipt_nft_ata: <span class="type">Box</span>&lt;Account&lt;<span class="symbol">&#x27;info</span>, TokenAccount&gt;&gt;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨æˆ·å¥–åŠ±ä»£å¸è´¦æˆ·ï¼ˆæƒ©ç½šä»£å¸å°†ä»è¿™é‡Œé”€æ¯ï¼‰</span></span><br><span class="line">    <span class="meta">#[account(</span></span><br><span class="line"><span class="meta">        init_if_needed,                        // å¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»ºï¼ˆé˜²æ­¢ç”¨æˆ·æ²¡æœ‰è¯¥ä»£å¸è´¦æˆ·ï¼‰</span></span><br><span class="line"><span class="meta">        payer = authority,                     // åˆ›å»ºè´¹ç”¨æ”¯ä»˜è€…</span></span><br><span class="line"><span class="meta">        associated_token::mint = token_mint_account, // å…³è”åˆ°å¥–åŠ±ä»£å¸mint</span></span><br><span class="line"><span class="meta">        associated_token::authority = authority,     // è´¦æˆ·æ‰€æœ‰è€…ä¸ºç”¨æˆ·</span></span><br><span class="line"><span class="meta">    )]</span></span><br><span class="line">    <span class="keyword">pub</span> associated_token_account: <span class="type">Box</span>&lt;Account&lt;<span class="symbol">&#x27;info</span>, TokenAccount&gt;&gt;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¥–åŠ±ä»£å¸çš„mintè´¦æˆ·ï¼ˆç”¨äºé”€æ¯ä»£å¸ï¼‰</span></span><br><span class="line">    <span class="meta">#[account(</span></span><br><span class="line"><span class="meta">        mut,                                   // å¯å˜ï¼Œå› ä¸ºé”€æ¯ä»£å¸ä¼šå½±å“supply</span></span><br><span class="line"><span class="meta">        seeds = [</span></span><br><span class="line"><span class="meta">            b<span class="string">&quot;mint_v9&quot;</span>,                        // mintè´¦æˆ·çš„ç§å­</span></span><br><span class="line"><span class="meta">        ]</span>,</span><br><span class="line">        bump,                                  <span class="comment">// è‡ªåŠ¨å¯»æ‰¾bumpå€¼</span></span><br><span class="line">    )]</span><br><span class="line">    <span class="keyword">pub</span> token_mint_account: <span class="type">Box</span>&lt;Account&lt;<span class="symbol">&#x27;info</span>, Mint&gt;&gt;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¢«è§£è´¨æŠ¼çš„NFT mintè´¦æˆ·</span></span><br><span class="line">    <span class="meta">#[account(mut)]</span>  <span class="comment">// å¯å˜ï¼Œä¿æŒä¸è´¨æŠ¼æ—¶çš„ä¸€è‡´æ€§</span></span><br><span class="line">    <span class="keyword">pub</span> nft_mint_account: <span class="type">Box</span>&lt;Account&lt;<span class="symbol">&#x27;info</span>, Mint&gt;&gt;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨æˆ·çš„NFTæ¥æ”¶è´¦æˆ·ï¼ˆNFTå°†è½¬ç§»åˆ°è¿™é‡Œï¼‰</span></span><br><span class="line">    <span class="meta">#[account(</span></span><br><span class="line"><span class="meta">        mut,                                   // å¯å˜ï¼ŒNFTå°†è¢«è½¬å…¥</span></span><br><span class="line"><span class="meta">        associated_token::mint = nft_mint_account,  // å…³è”åˆ°NFT mint</span></span><br><span class="line"><span class="meta">        associated_token::authority = authority,    // è´¦æˆ·æ‰€æœ‰è€…ä¸ºç”¨æˆ·</span></span><br><span class="line"><span class="meta">    )]</span></span><br><span class="line">    <span class="keyword">pub</span> nft_associated_token_account: <span class="type">Box</span>&lt;Account&lt;<span class="symbol">&#x27;info</span>, TokenAccount&gt;&gt;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// äº¤æ˜“å‘èµ·è€…å’Œè´¹ç”¨æ”¯ä»˜è€…</span></span><br><span class="line">    <span class="meta">#[account(mut)]</span>  <span class="comment">// å¯å˜ï¼Œéœ€è¦æ”¯ä»˜äº¤æ˜“è´¹ç”¨</span></span><br><span class="line">    <span class="keyword">pub</span> authority: Signer&lt;<span class="symbol">&#x27;info</span>&gt;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰€éœ€çš„ç¨‹åºè´¦æˆ·</span></span><br><span class="line">    <span class="keyword">pub</span> system_program: Program&lt;<span class="symbol">&#x27;info</span>, System&gt;,                    <span class="comment">// Solanaç³»ç»Ÿç¨‹åº</span></span><br><span class="line">    <span class="keyword">pub</span> token_program: Program&lt;<span class="symbol">&#x27;info</span>, Token&gt;,                      <span class="comment">// SPL Tokenç¨‹åº</span></span><br><span class="line">    <span class="keyword">pub</span> associated_token_program: Program&lt;<span class="symbol">&#x27;info</span>, AssociatedToken&gt;, <span class="comment">// å…³è”ä»£å¸ç¨‹åº</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>è§£è´¨æŠ¼æµç¨‹å›¾è§£</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·å‘èµ·è§£è´¨æŠ¼è¯·æ±‚</span><br><span class="line">    â†“</span><br><span class="line">éªŒè¯ç”¨æˆ·æƒé™ï¼ˆæ˜¯å¦ä¸ºåŸè´¨æŠ¼è€…ï¼‰</span><br><span class="line">    â†“</span><br><span class="line">è®¡ç®—æƒ©ç½šé‡‘é¢ï¼ˆåŸºäºè´¨æŠ¼æ—¶é•¿ï¼‰</span><br><span class="line">    â†“</span><br><span class="line">NFTä»æ‰˜ç®¡è´¦æˆ· â†’ ç”¨æˆ·è´¦æˆ·</span><br><span class="line">    â†“</span><br><span class="line">é”€æ¯æƒ©ç½šæ•°é‡çš„å¥–åŠ±ä»£å¸</span><br><span class="line">    â†“</span><br><span class="line">è§£è´¨æŠ¼å®Œæˆ</span><br></pre></td></tr></table></figure>

<h2 id="æ­¥éª¤3-æ³¨å†Œè§£è´¨æŠ¼æŒ‡ä»¤"><a href="#æ­¥éª¤3-æ³¨å†Œè§£è´¨æŠ¼æŒ‡ä»¤" class="headerlink" title="æ­¥éª¤3: æ³¨å†Œè§£è´¨æŠ¼æŒ‡ä»¤"></a>æ­¥éª¤3: æ³¨å†Œè§£è´¨æŠ¼æŒ‡ä»¤</h2><p><strong>ç›®çš„</strong>: åœ¨ä¸»ç¨‹åºæ–‡ä»¶ä¸­æ³¨å†ŒNFTè§£è´¨æŠ¼æŒ‡ä»¤ï¼Œä½¿å…¶å¯ä»¥è¢«å®¢æˆ·ç«¯è°ƒç”¨ã€‚</p>
<p><strong>æ–‡ä»¶ä½ç½®</strong>: <code>/programs/ibuidl-socail/src/lib.rs</code></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// NFTè§£è´¨æŠ¼æŒ‡ä»¤çš„å…¬å…±æ¥å£</span></span><br><span class="line"><span class="comment">// è¿™ä¸ªå‡½æ•°æš´éœ²ç»™å®¢æˆ·ç«¯ï¼Œç”¨äºè§£è´¨æŠ¼NFT</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">nft_unstake</span>(ctx: Context&lt;NftUnstake&gt;) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;()&gt; &#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨å…·ä½“çš„è§£è´¨æŠ¼å®ç°é€»è¾‘</span></span><br><span class="line">    instructions::nft_unstake::<span class="title function_ invoke__">unstake</span>(ctx)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ­¥éª¤4-å®¢æˆ·ç«¯è§£è´¨æŠ¼å®ç°"><a href="#æ­¥éª¤4-å®¢æˆ·ç«¯è§£è´¨æŠ¼å®ç°" class="headerlink" title="æ­¥éª¤4: å®¢æˆ·ç«¯è§£è´¨æŠ¼å®ç°"></a>æ­¥éª¤4: å®¢æˆ·ç«¯è§£è´¨æŠ¼å®ç°</h2><p><strong>ç›®çš„</strong>: åœ¨å®¢æˆ·ç«¯å®ç°è§£è´¨æŠ¼åŠŸèƒ½ï¼Œä¸é“¾ä¸Šç¨‹åºäº¤äº’å‘é€è§£è´¨æŠ¼äº¤æ˜“ã€‚</p>
<p><strong>æ–‡ä»¶ä½ç½®</strong>: <code>/app/api/stake.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; program &#125; <span class="keyword">from</span> <span class="string">&quot;./wallet&quot;</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> anchor <span class="keyword">from</span> <span class="string">&quot;@coral-xyz/anchor&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®¢æˆ·ç«¯NFTè§£è´¨æŠ¼å‡½æ•°</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">nftUnstake</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="attr">wallet</span>: anchor.<span class="title class_">Wallet</span>,      <span class="comment">// ç”¨æˆ·é’±åŒ…</span></span></span><br><span class="line"><span class="params">    <span class="attr">id</span>: <span class="built_in">string</span>,                 <span class="comment">// NFTçš„å”¯ä¸€ID</span></span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> program.<span class="property">methods</span>.<span class="title function_">nftUnstake</span>()  <span class="comment">// è°ƒç”¨è§£è´¨æŠ¼æ–¹æ³•</span></span><br><span class="line">        .<span class="title function_">accounts</span>(&#123;</span><br><span class="line">            <span class="comment">// æŒ‡å®šNFT mintè´¦æˆ·åœ°å€å’Œæƒé™è´¦æˆ·</span></span><br><span class="line">            <span class="attr">nftMintAccount</span>: <span class="title function_">getNftMintAccount</span>(id),  <span class="comment">// NFT mintåœ°å€</span></span><br><span class="line">            <span class="attr">authority</span>: wallet.<span class="property">payer</span>.<span class="property">publicKey</span>,      <span class="comment">// æ˜¾å¼æŒ‡å®šæƒé™è´¦æˆ·</span></span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">signers</span>([wallet.<span class="property">payer</span>])                   <span class="comment">// äº¤æ˜“ç­¾åè€…</span></span><br><span class="line">        .<span class="title function_">rpc</span>();                                    <span class="comment">// é€šè¿‡RPCå‘é€äº¤æ˜“</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ¹æ®NFT IDè®¡ç®—NFT mintè´¦æˆ·åœ°å€çš„å·¥å…·å‡½æ•°</span></span><br><span class="line"><span class="comment">// è¿™ä¸ªåœ°å€å¿…é¡»ä¸é“¸é€ NFTæ—¶ä½¿ç”¨çš„ç›¸åŒPDAåœ°å€</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getNftMintAccount</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="attr">id</span>: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ä¸NFTé“¸é€ æ—¶ç›¸åŒçš„ç§å­ç”ŸæˆPDAåœ°å€</span></span><br><span class="line">    <span class="keyword">const</span> [mintAccount] = anchor.<span class="property">web3</span>.<span class="property">PublicKey</span>.<span class="title function_">findProgramAddressSync</span>(</span><br><span class="line">        [</span><br><span class="line">            <span class="title class_">Buffer</span>.<span class="title function_">from</span>(<span class="string">&quot;mint_nft_v1&quot;</span>),        <span class="comment">// ç§å­å‰ç¼€ï¼ˆä¸NFTé“¸é€ æ—¶ä¸€è‡´ï¼‰</span></span><br><span class="line">            <span class="title class_">Buffer</span>.<span class="title function_">from</span>(id),                   <span class="comment">// NFTå”¯ä¸€ID</span></span><br><span class="line">        ],</span><br><span class="line">        program.<span class="property">programId</span>,                     <span class="comment">// ç¨‹åºID</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ğŸ” NFT Mint Account:&quot;</span>, mintAccount.<span class="title function_">toString</span>());</span><br><span class="line">    <span class="keyword">return</span> mintAccount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>é‡è¦è¯´æ˜</strong>:</p>
<ul>
<li><code>authority: wallet.payer.publicKey</code>: æ˜¾å¼æŒ‡å®šæƒé™è´¦æˆ·ï¼Œç¡®ä¿æƒé™éªŒè¯æ­£ç¡®</li>
<li>ç§å­ç”Ÿæˆå¿…é¡»ä¸NFTé“¸é€ å’Œè´¨æŠ¼æ—¶å®Œå…¨ä¸€è‡´</li>
</ul>
<h2 id="æ­¥éª¤5-å®Œæ•´åº”ç”¨æ¼”ç¤º"><a href="#æ­¥éª¤5-å®Œæ•´åº”ç”¨æ¼”ç¤º" class="headerlink" title="æ­¥éª¤5: å®Œæ•´åº”ç”¨æ¼”ç¤º"></a>æ­¥éª¤5: å®Œæ•´åº”ç”¨æ¼”ç¤º</h2><p><strong>ç›®çš„</strong>: å±•ç¤ºå¦‚ä½•åœ¨å®Œæ•´åº”ç”¨ä¸­ä½¿ç”¨NFTè§£è´¨æŠ¼åŠŸèƒ½ã€‚</p>
<p><strong>æ–‡ä»¶ä½ç½®</strong>: <code>/app/index.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createProfile, getProfile &#125; <span class="keyword">from</span> <span class="string">&quot;./api/profile&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createTweet, getTweet, createLike &#125; <span class="keyword">from</span> <span class="string">&quot;./api/tweet&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useDefaultWallet, useVisitorWallet &#125; <span class="keyword">from</span> <span class="string">&quot;./api/wallet&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createTokenMintAccount &#125; <span class="keyword">from</span> <span class="string">&quot;./api/token&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; nftMint &#125; <span class="keyword">from</span> <span class="string">&quot;./api/nft&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; nftStake, nftUnstake &#125; <span class="keyword">from</span> <span class="string">&quot;./api/stake&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NFTè§£è´¨æŠ¼æ¼”ç¤ºæµç¨‹</span></span><br><span class="line">(<span class="title function_">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–é’±åŒ…</span></span><br><span class="line">    <span class="keyword">const</span> defaultWallet = <span class="title function_">useDefaultWallet</span>();</span><br><span class="line">    <span class="keyword">const</span> visitorwallet = <span class="title function_">useVisitorWallet</span>();</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ğŸ”‘ Default wallet:&quot;</span>, defaultWallet.<span class="property">publicKey</span>.<span class="title function_">toString</span>());</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ğŸ”‘ Visitor wallet:&quot;</span>, visitorwallet.<span class="property">publicKey</span>.<span class="title function_">toString</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// æ¼”ç¤ºå®Œæ•´çš„è´¨æŠ¼-è§£è´¨æŠ¼æµç¨‹</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬ä¸€æ­¥ï¼šè´¨æŠ¼NFTï¼ˆå¦‚æœå°šæœªè´¨æŠ¼ï¼‰</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ğŸ“¥ Step 1: Staking NFT...&quot;</span>);</span><br><span class="line">        <span class="comment">// const nftStakeResult = await nftStake(defaultWallet, &quot;3&quot;);</span></span><br><span class="line">        <span class="comment">// console.log(&quot;âœ… NFT staked successfully:&quot;, nftStakeResult);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼ˆåœ¨å®é™…åº”ç”¨ä¸­ï¼Œç”¨æˆ·ä¼šåœ¨ä¸åŒæ—¶é—´è¿›è¡Œæ“ä½œï¼‰</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;â³ Waiting for some epochs to pass...&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ç¬¬äºŒæ­¥ï¼šè§£è´¨æŠ¼NFT</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ğŸ“¤ Step 2: Unstaking NFT...&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> nftUnstakeResult = <span class="keyword">await</span> <span class="title function_">nftUnstake</span>(defaultWallet, <span class="string">&quot;3&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;âœ… NFT unstaked successfully!&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ğŸ“‹ Transaction signature:&quot;</span>, nftUnstakeResult);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è§£è´¨æŠ¼æˆåŠŸåçš„åç»­æ“ä½œï¼š</span></span><br><span class="line">        <span class="comment">// 1. æŸ¥è¯¢ç”¨æˆ·NFTä½™é¢ï¼ˆåº”è¯¥æ¢å¤åˆ°1ä¸ªï¼‰</span></span><br><span class="line">        <span class="comment">// 2. æŸ¥è¯¢å¥–åŠ±ä»£å¸ä½™é¢ï¼ˆåº”è¯¥å‡å°‘äº†æƒ©ç½šé‡‘é¢ï¼‰</span></span><br><span class="line">        <span class="comment">// 3. æ¸…ç†è´¨æŠ¼ä¿¡æ¯è´¦æˆ·ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">        <span class="comment">// 4. æ›´æ–°ç”¨æˆ·ç•Œé¢æ˜¾ç¤º</span></span><br><span class="line">        </span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;âŒ Failed to unstake NFT:&quot;</span>, error);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¸¸è§é”™è¯¯å¤„ç†ï¼š</span></span><br><span class="line">        <span class="comment">// - ç”¨æˆ·ä¸æ˜¯åŸè´¨æŠ¼è€…</span></span><br><span class="line">        <span class="comment">// - NFTå°šæœªè´¨æŠ¼</span></span><br><span class="line">        <span class="comment">// - å¥–åŠ±ä»£å¸ä½™é¢ä¸è¶³æ”¯ä»˜æƒ©ç½š</span></span><br><span class="line">        <span class="comment">// - è´¦æˆ·ä¸å­˜åœ¨æˆ–çŠ¶æ€å¼‚å¸¸</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ ¹æ®é”™è¯¯ç±»å‹æä¾›ç›¸åº”çš„ç”¨æˆ·æç¤º</span></span><br><span class="line">        <span class="keyword">if</span> (error.<span class="property">message</span>.<span class="title function_">includes</span>(<span class="string">&quot;NoAuthority&quot;</span>)) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ğŸ’¡ Tip: Only the original staker can unstake this NFT&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (error.<span class="property">message</span>.<span class="title function_">includes</span>(<span class="string">&quot;InsufficientFunds&quot;</span>)) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ğŸ’¡ Tip: Not enough reward tokens to pay the penalty&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>

<h2 id="æŠ€æœ¯è¦ç‚¹æ·±åº¦è§£æ"><a href="#æŠ€æœ¯è¦ç‚¹æ·±åº¦è§£æ" class="headerlink" title="æŠ€æœ¯è¦ç‚¹æ·±åº¦è§£æ"></a>æŠ€æœ¯è¦ç‚¹æ·±åº¦è§£æ</h2><h3 id="1-æƒé™éªŒè¯æœºåˆ¶"><a href="#1-æƒé™éªŒè¯æœºåˆ¶" class="headerlink" title="1. æƒé™éªŒè¯æœºåˆ¶"></a>1. æƒé™éªŒè¯æœºåˆ¶</h3><h4 id="A-åŒé‡æƒé™æ£€æŸ¥"><a href="#A-åŒé‡æƒé™æ£€æŸ¥" class="headerlink" title="A. åŒé‡æƒé™æ£€æŸ¥"></a>A. åŒé‡æƒé™æ£€æŸ¥</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ£€æŸ¥1ï¼šNFTåŒ¹é…éªŒè¯</span></span><br><span class="line">require!(</span><br><span class="line">    &amp;ctx.accounts.stake_info.nft_mint_account.<span class="title function_ invoke__">key</span>() == &amp;ctx.accounts.nft_mint_account.<span class="title function_ invoke__">key</span>(),</span><br><span class="line">    UnstakeError::NoAuthority,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥2ï¼šåŸè´¨æŠ¼è€…éªŒè¯  </span></span><br><span class="line">require!(</span><br><span class="line">    &amp;ctx.accounts.stake_info.staker.<span class="title function_ invoke__">key</span>() == &amp;ctx.accounts.authority.<span class="title function_ invoke__">key</span>(),</span><br><span class="line">    UnstakeError::NoAuthority,</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><strong>ä½œç”¨</strong>:</p>
<ul>
<li>é˜²æ­¢ç”¨æˆ·è§£è´¨æŠ¼ä»–äººçš„NFT</li>
<li>ç¡®ä¿æ“ä½œçš„NFTä¸è´¨æŠ¼è®°å½•åŒ¹é…</li>
<li>æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯</li>
</ul>
<h4 id="B-PDAæƒé™æ§åˆ¶"><a href="#B-PDAæƒé™æ§åˆ¶" class="headerlink" title="B. PDAæƒé™æ§åˆ¶"></a>B. PDAæƒé™æ§åˆ¶</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">signer_seeds</span>: &amp;[&amp;[&amp;[<span class="type">u8</span>]]] = &amp;[&amp;[</span><br><span class="line">    IbuidlStake::SEED_PREFIX.<span class="title function_ invoke__">as_bytes</span>(),</span><br><span class="line">    nft_mint_account.<span class="title function_ invoke__">as_ref</span>(),</span><br><span class="line">    &amp;[ctx.bumps.stake_info],</span><br><span class="line">]];</span><br></pre></td></tr></table></figure>

<p><strong>é‡è¦æ€§</strong>:</p>
<ul>
<li>åªæœ‰ç¨‹åºèƒ½ç”Ÿæˆæ­£ç¡®çš„PDAç­¾å</li>
<li>é˜²æ­¢å¤–éƒ¨è´¦æˆ·ä¼ªé€ æƒé™</li>
<li>ç¡®ä¿èµ„äº§å®‰å…¨è½¬ç§»</li>
</ul>
<h3 id="2-æƒ©ç½šæœºåˆ¶è¯¦è§£"><a href="#2-æƒ©ç½šæœºåˆ¶è¯¦è§£" class="headerlink" title="2. æƒ©ç½šæœºåˆ¶è¯¦è§£"></a>2. æƒ©ç½šæœºåˆ¶è¯¦è§£</h3><h4 id="A-çº¿æ€§è¡°å‡å…¬å¼"><a href="#A-çº¿æ€§è¡°å‡å…¬å¼" class="headerlink" title="A. çº¿æ€§è¡°å‡å…¬å¼"></a>A. çº¿æ€§è¡°å‡å…¬å¼</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">penalty_rate</span> = <span class="title function_ invoke__">max</span>(<span class="number">0</span>, <span class="number">100</span> - staked_duration * <span class="number">2</span>) <span class="keyword">as</span> <span class="type">f64</span> / <span class="number">100.0</span>;</span><br></pre></td></tr></table></figure>

<p><strong>æ•°å­¦æ¨¡å‹</strong>:</p>
<ul>
<li>åˆå§‹æƒ©ç½š: 100%</li>
<li>è¡°å‡é€Ÿåº¦: æ¯epochå‡å°‘2%</li>
<li>é›¶æƒ©ç½šç‚¹: 50ä¸ªepochå</li>
<li>æœ€å°æƒ©ç½š: 0%</li>
</ul>
<h4 id="B-ç»æµå­¦è€ƒé‡"><a href="#B-ç»æµå­¦è€ƒé‡" class="headerlink" title="B. ç»æµå­¦è€ƒé‡"></a>B. ç»æµå­¦è€ƒé‡</h4><ul>
<li><strong>çŸ­æœŸæŠ•æœºæˆæœ¬</strong>: æ—©æœŸè§£è´¨æŠ¼æŸå¤±å¤§</li>
<li><strong>é•¿æœŸæŒæœ‰å¥–åŠ±</strong>: æ—¶é—´è¶Šé•¿æŸå¤±è¶Šå°</li>
<li><strong>æµåŠ¨æ€§å¹³è¡¡</strong>: å…è®¸ç´§æ€¥é€€å‡ºä½†æœ‰æˆæœ¬</li>
</ul>
<h3 id="3-ä»£å¸é”€æ¯æœºåˆ¶"><a href="#3-ä»£å¸é”€æ¯æœºåˆ¶" class="headerlink" title="3. ä»£å¸é”€æ¯æœºåˆ¶"></a>3. ä»£å¸é”€æ¯æœºåˆ¶</h3><h4 id="A-Burnæ“ä½œ"><a href="#A-Burnæ“ä½œ" class="headerlink" title="A. Burnæ“ä½œ"></a>A. Burnæ“ä½œ</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">burn</span>(</span><br><span class="line">    CpiContext::<span class="title function_ invoke__">new</span>(<span class="comment">/* ... */</span>),</span><br><span class="line">    penalty_amount,</span><br><span class="line">)?;</span><br></pre></td></tr></table></figure>

<p><strong>æ•ˆæœ</strong>:</p>
<ul>
<li>æ°¸ä¹…å‡å°‘ä»£å¸æ€»ä¾›åº”é‡</li>
<li>å¯¹å‰©ä½™æŒæœ‰è€…æœ‰é€šç¼©æ•ˆåº”</li>
<li>é˜²æ­¢ä»£å¸é€šèƒ€</li>
</ul>
<h4 id="B-ç»æµå½±å“"><a href="#B-ç»æµå½±å“" class="headerlink" title="B. ç»æµå½±å“"></a>B. ç»æµå½±å“</h4><ul>
<li><strong>ä¾›åº”å‡å°‘</strong>: é”€æ¯ä»£å¸å‡å°‘æµé€šé‡</li>
<li><strong>ä»·å€¼æ”¯æ’‘</strong>: é€šç¼©æœºåˆ¶æ”¯æ’‘ä»£å¸ä»·å€¼</li>
<li><strong>æ¿€åŠ±å¯¹é½</strong>: é¼“åŠ±é•¿æœŸæŒæœ‰</li>
</ul>
<h3 id="4-é”™è¯¯å¤„ç†ç­–ç•¥"><a href="#4-é”™è¯¯å¤„ç†ç­–ç•¥" class="headerlink" title="4. é”™è¯¯å¤„ç†ç­–ç•¥"></a>4. é”™è¯¯å¤„ç†ç­–ç•¥</h3><h4 id="A-é¢„æ£€æŸ¥æœºåˆ¶"><a href="#A-é¢„æ£€æŸ¥æœºåˆ¶" class="headerlink" title="A. é¢„æ£€æŸ¥æœºåˆ¶"></a>A. é¢„æ£€æŸ¥æœºåˆ¶</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[account(</span></span><br><span class="line"><span class="meta">    init_if_needed,</span></span><br><span class="line"><span class="meta">    payer = authority,</span></span><br><span class="line"><span class="meta">    associated_token::mint = token_mint_account,</span></span><br><span class="line"><span class="meta">    associated_token::authority = authority,</span></span><br><span class="line"><span class="meta">)]</span></span><br></pre></td></tr></table></figure>

<p><strong>ä¼˜åŠ¿</strong>:</p>
<ul>
<li>è‡ªåŠ¨åˆ›å»ºç¼ºå¤±è´¦æˆ·</li>
<li>å‡å°‘ç”¨æˆ·æ“ä½œæ­¥éª¤</li>
<li>æé«˜äº¤æ˜“æˆåŠŸç‡</li>
</ul>
<h4 id="B-è¾¹ç•Œæ¡ä»¶å¤„ç†"><a href="#B-è¾¹ç•Œæ¡ä»¶å¤„ç†" class="headerlink" title="B. è¾¹ç•Œæ¡ä»¶å¤„ç†"></a>B. è¾¹ç•Œæ¡ä»¶å¤„ç†</h4><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> penalty_amount &gt; <span class="number">0</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">burn</span>(<span class="comment">/* ... */</span>)?;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    msg!(<span class="string">&quot;No penalty - full staking period completed!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-Gasä¼˜åŒ–ç­–ç•¥"><a href="#5-Gasä¼˜åŒ–ç­–ç•¥" class="headerlink" title="5. Gasä¼˜åŒ–ç­–ç•¥"></a>5. Gasä¼˜åŒ–ç­–ç•¥</h3><h4 id="A-æ¡ä»¶æ‰§è¡Œ"><a href="#A-æ¡ä»¶æ‰§è¡Œ" class="headerlink" title="A. æ¡ä»¶æ‰§è¡Œ"></a>A. æ¡ä»¶æ‰§è¡Œ</h4><ul>
<li>åªåœ¨æœ‰æƒ©ç½šæ—¶æ‰§è¡Œburnæ“ä½œ</li>
<li>å‡å°‘ä¸å¿…è¦çš„è®¡ç®—å’Œæ“ä½œ</li>
</ul>
<h4 id="B-è´¦æˆ·å¤ç”¨"><a href="#B-è´¦æˆ·å¤ç”¨" class="headerlink" title="B. è´¦æˆ·å¤ç”¨"></a>B. è´¦æˆ·å¤ç”¨</h4><ul>
<li>å¤ç”¨è´¨æŠ¼æ—¶åˆ›å»ºçš„è´¦æˆ·</li>
<li>å‡å°‘è´¦æˆ·åˆ›å»ºæˆæœ¬</li>
</ul>
<h2 id="å®‰å…¨æ€§åˆ†æ"><a href="#å®‰å…¨æ€§åˆ†æ" class="headerlink" title="å®‰å…¨æ€§åˆ†æ"></a>å®‰å…¨æ€§åˆ†æ</h2><h3 id="1-é‡å…¥æ”»å‡»é˜²æŠ¤"><a href="#1-é‡å…¥æ”»å‡»é˜²æŠ¤" class="headerlink" title="1. é‡å…¥æ”»å‡»é˜²æŠ¤"></a>1. é‡å…¥æ”»å‡»é˜²æŠ¤</h3><ul>
<li><strong>å•ä¸€æ‰§è¡Œè·¯å¾„</strong>: æ¯ä¸ªæŒ‡ä»¤éƒ½æ˜¯åŸå­æ“ä½œ</li>
<li><strong>çŠ¶æ€ä¸€è‡´æ€§</strong>: æ‰€æœ‰çŠ¶æ€å˜æ›´åœ¨å•ä¸ªäº¤æ˜“ä¸­å®Œæˆ</li>
</ul>
<h3 id="2-æƒé™æå‡é˜²æŠ¤"><a href="#2-æƒé™æå‡é˜²æŠ¤" class="headerlink" title="2. æƒé™æå‡é˜²æŠ¤"></a>2. æƒé™æå‡é˜²æŠ¤</h3><ul>
<li><strong>PDAæ§åˆ¶</strong>: å…³é”®æ“ä½œç”±PDAæ§åˆ¶ï¼Œå¤–éƒ¨æ— æ³•ä¼ªé€ </li>
<li><strong>ç­¾åéªŒè¯</strong>: æ‰€æœ‰æ“ä½œéƒ½éœ€è¦æ­£ç¡®çš„æ•°å­—ç­¾å</li>
</ul>
<h3 id="3-æ•°å€¼æº¢å‡ºé˜²æŠ¤"><a href="#3-æ•°å€¼æº¢å‡ºé˜²æŠ¤" class="headerlink" title="3. æ•°å€¼æº¢å‡ºé˜²æŠ¤"></a>3. æ•°å€¼æº¢å‡ºé˜²æŠ¤</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::cmp::max;  <span class="comment">// ä½¿ç”¨å®‰å…¨çš„æ•°å­¦æ“ä½œ</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">penalty_rate</span> = <span class="title function_ invoke__">max</span>(<span class="number">0</span>, <span class="number">100</span> - staked_duration * <span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<h2 id="æ‰©å±•åŠŸèƒ½å»ºè®®"><a href="#æ‰©å±•åŠŸèƒ½å»ºè®®" class="headerlink" title="æ‰©å±•åŠŸèƒ½å»ºè®®"></a>æ‰©å±•åŠŸèƒ½å»ºè®®</h2><h3 id="1-æ¸è¿›å¼è§£è´¨æŠ¼"><a href="#1-æ¸è¿›å¼è§£è´¨æŠ¼" class="headerlink" title="1. æ¸è¿›å¼è§£è´¨æŠ¼"></a>1. æ¸è¿›å¼è§£è´¨æŠ¼</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…è®¸éƒ¨åˆ†è§£è´¨æŠ¼ï¼ŒæŒ‰æ¯”ä¾‹è®¡ç®—æƒ©ç½š</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">partial_unstake</span>(&amp;<span class="keyword">self</span>, amount: <span class="type">u64</span>, total_staked: <span class="type">u64</span>) <span class="punctuation">-&gt;</span> <span class="type">u64</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">penalty_rate</span> = <span class="keyword">self</span>.<span class="title function_ invoke__">calculate_penalty_rate</span>();</span><br><span class="line">    (amount <span class="keyword">as</span> <span class="type">f64</span> * penalty_rate) <span class="keyword">as</span> <span class="type">u64</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-åŠ¨æ€æƒ©ç½šç‡"><a href="#2-åŠ¨æ€æƒ©ç½šç‡" class="headerlink" title="2. åŠ¨æ€æƒ©ç½šç‡"></a>2. åŠ¨æ€æƒ©ç½šç‡</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ®ç½‘ç»œçŠ¶å†µè°ƒæ•´æƒ©ç½šå‚æ•°</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">dynamic_penalty</span>(&amp;<span class="keyword">self</span>, network_load: <span class="type">f64</span>) <span class="punctuation">-&gt;</span> <span class="type">f64</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">base_penalty</span> = <span class="keyword">self</span>.<span class="title function_ invoke__">calculate_base_penalty</span>();</span><br><span class="line">    base_penalty * (<span class="number">1.0</span> + network_load * <span class="number">0.1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-å¥–åŠ±ç´¯ç§¯æœºåˆ¶"><a href="#3-å¥–åŠ±ç´¯ç§¯æœºåˆ¶" class="headerlink" title="3. å¥–åŠ±ç´¯ç§¯æœºåˆ¶"></a>3. å¥–åŠ±ç´¯ç§¯æœºåˆ¶</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¡ç®—å¹¶å‘æ”¾ç´¯ç§¯çš„è´¨æŠ¼å¥–åŠ±</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">calculate_rewards</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">u64</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">duration</span> = Clock::<span class="title function_ invoke__">get</span>().<span class="title function_ invoke__">unwrap</span>().epoch - <span class="keyword">self</span>.staked_at;</span><br><span class="line">    duration * REWARD_PER_EPOCH</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-æ‰¹é‡æ“ä½œæ”¯æŒ"><a href="#4-æ‰¹é‡æ“ä½œæ”¯æŒ" class="headerlink" title="4. æ‰¹é‡æ“ä½œæ”¯æŒ"></a>4. æ‰¹é‡æ“ä½œæ”¯æŒ</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ”¯æŒæ‰¹é‡è§£è´¨æŠ¼å¤šä¸ªNFT</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">batch_unstake</span>(nft_ids: <span class="type">Vec</span>&lt;<span class="type">String</span>&gt;) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;()&gt; &#123;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">id</span> <span class="keyword">in</span> nft_ids &#123;</span><br><span class="line">        <span class="comment">// æ‰§è¡Œå•ä¸ªè§£è´¨æŠ¼æ“ä½œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æœ€ä½³å®è·µæ€»ç»“"><a href="#æœ€ä½³å®è·µæ€»ç»“" class="headerlink" title="æœ€ä½³å®è·µæ€»ç»“"></a>æœ€ä½³å®è·µæ€»ç»“</h2><h3 id="1-å®‰å…¨ä¼˜å…ˆ"><a href="#1-å®‰å…¨ä¼˜å…ˆ" class="headerlink" title="1. å®‰å…¨ä¼˜å…ˆ"></a>1. å®‰å…¨ä¼˜å…ˆ</h3><ul>
<li>å§‹ç»ˆéªŒè¯ç”¨æˆ·æƒé™</li>
<li>ä½¿ç”¨PDAæ§åˆ¶å…³é”®èµ„äº§</li>
<li>å®ç°å®Œæ•´çš„é”™è¯¯å¤„ç†</li>
</ul>
<h3 id="2-ç”¨æˆ·ä½“éªŒ"><a href="#2-ç”¨æˆ·ä½“éªŒ" class="headerlink" title="2. ç”¨æˆ·ä½“éªŒ"></a>2. ç”¨æˆ·ä½“éªŒ</h3><ul>
<li>æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯</li>
<li>è‡ªåŠ¨å¤„ç†è´¦æˆ·åˆ›å»º</li>
<li>æ”¯æŒæ¡ä»¶æ€§æ“ä½œ</li>
</ul>
<h3 id="3-ç»æµè®¾è®¡"><a href="#3-ç»æµè®¾è®¡" class="headerlink" title="3. ç»æµè®¾è®¡"></a>3. ç»æµè®¾è®¡</h3><ul>
<li>å¹³è¡¡æµåŠ¨æ€§å’Œç¨³å®šæ€§</li>
<li>ä½¿ç”¨é€šç¼©æœºåˆ¶æ”¯æ’‘ä»·å€¼</li>
<li>æä¾›åˆç†çš„é€€å‡ºæˆæœ¬</li>
</ul>
<h3 id="4-å¯æ‰©å±•æ€§"><a href="#4-å¯æ‰©å±•æ€§" class="headerlink" title="4. å¯æ‰©å±•æ€§"></a>4. å¯æ‰©å±•æ€§</h3><ul>
<li>æ¨¡å—åŒ–è®¾è®¡ä¾¿äºæ‰©å±•</li>
<li>å‚æ•°åŒ–é…ç½®æ”¯æŒè°ƒæ•´</li>
<li>ç‰ˆæœ¬åŒ–è´¦æˆ·ç»“æ„</li>
</ul>
<p>è¿™ä¸ªå®Œæ•´çš„NFTè§£è´¨æŠ¼æ•™ç¨‹å±•ç¤ºäº†å¦‚ä½•æ„å»ºä¸€ä¸ªå®‰å…¨ã€å…¬å¹³ä¸”ç”¨æˆ·å‹å¥½çš„è§£è´¨æŠ¼ç³»ç»Ÿã€‚é€šè¿‡åˆç†çš„æƒ©ç½šæœºåˆ¶è®¾è®¡ï¼Œæ—¢ä¿æŠ¤äº†åè®®çš„ç¨³å®šæ€§ï¼Œåˆä¸ºç”¨æˆ·æä¾›äº†å¿…è¦çš„æµåŠ¨æ€§é€‰æ‹©ã€‚</p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/09/19/Solana%E8%B4%A8%E6%8A%BC-%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E5%BA%94%E7%94%A8%E7%BA%A7%E5%88%AB%E7%9A%84%E8%B4%A8%E6%8A%BC%E5%90%88%E7%BA%A6-%E8%B4%A8%E6%8A%BC%E9%80%BB%E8%BE%91-nft-stake/" rel="prev" title="Solanaè´¨æŠ¼-ç¼–å†™ä¸€ä¸ªåº”ç”¨çº§åˆ«çš„è´¨æŠ¼åˆçº¦-è´¨æŠ¼é€»è¾‘-nft-stake">
                  <i class="fa fa-angle-left"></i> Solanaè´¨æŠ¼-ç¼–å†™ä¸€ä¸ªåº”ç”¨çº§åˆ«çš„è´¨æŠ¼åˆçº¦-è´¨æŠ¼é€»è¾‘-nft-stake
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/09/20/Solana-PDA%E7%AD%BE%E5%90%8D%E7%A7%8D%E5%AD%90%E8%AF%A6%E8%A7%A3-stake-vs-unstake/" rel="next" title="Solana PDAç­¾åç§å­è¯¦è§£ - stake vs unstake">
                  Solana PDAç­¾åç§å­è¯¦è§£ - stake vs unstake <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">samxie</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
